import numpy as np
import binascii

test1 = """     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+ """

real="""                                                                                                                                                                   |                                     
   +-------+                   +---------------------+                     +-----------+                         +---------------------------------------+         |                                 +-+ 
   |       |                   |                     |                     |           |                         |                                       |         |                                 | | 
   |       |   +---------------|---------------------|-----------------------------------------------------------------------------+           +---------------------+                               | | 
   |       |   |               |                     |                     |           |                         |                 |           |         |         | |                               | | 
   |   +-----------------+ +---+     +-----------+   |                     |           |                         |   +-------------+           |         |         | |                               | | 
   |   |   |   |         | |         |           |   |                     |           |                         |   |                         |         |         | |                               | | 
   |   |   | +-|---------|-----------|---------+ +-----------+             |           +-----------------------------|-------+                 |         |         | |                               | | 
   |   |   | | |         | |         |         |     |       |             |                                     |   |       |                 |         |         | |                               | | 
   |   |   | | |         +---+       |     +-------------------------------|-------------------------------------|-----------------------------+         |         | |                 +-------------+ | 
   |   |   | | |           | |       |     |   |     |       |             |                                     |   |       |                           |         | |                 |               | 
   |   |   | | |           | |     +-|-----|---|---------------------------|-----------+                         |   |       |                           |         | |                 |               | 
   |   |   | | |           | |     | |     |   |     |       |             |           |                         |   |       |                           |         | |                 |               | 
   |   |   | | |           | |     | |     |   +-----|-----+ |             |           |                 +-------|---|-------+                           |         | |                 |               | 
   |   |   | | |           | |     | |     |         |     | |             |           |                 |       |   |                                   |         | |                 |               | 
   |   |   | | |           | |     | |     |         |     +-|-------------------------+       +---------|-------|---------------------------------------|---------|-------------------|-+     +-+     | 
   |   |   | | |           | |     | |     |         |       |             |                   |         |       |   |                                   |         | |                 | |     | |     | 
   |   |   | +-|-------------|-----|-----------------------+ |             |                   |         |       |   |                                   |         | |                 | |     +-|-+   | 
   |   |   |   |           | |     | |     |         |     | |             |                   |         |       |   |                                   |         | |                 | |       | |   | 
   |   |   |   |           | |     | |     |   +-----|-------|-------------|-------------------|---------+       |   |                     +-------------|---------|I|-------------------------+ | |   | 
   |   |   |   |           | |     | |     |   |     |     | |             |                   |                 |   |                     |             |         | |                 | |     | | |   | 
   |   |   |   |           | |     | |     |   |     |     | |             |                   | +-----------+   |   |               +-----|------C------------------------------------+ |     | | |   | 
   |   |   |   |           | |     | |     |   |     |     | |             |                   | |           |   |   |               |     |             |         | |                   |     | | |   | 
   |   |   |   |   +-------|---------|-----|---------------|-|-------------|---------+         | |           |   +---|-------+       |     |   +---------|-----+   | |               +-+ |     | | |   | 
   |   |   |   |   |       | |     | |     |   |     |     | |             |         |         | |           |       |       |       |     |   |         |     |   | |               | | |     | | |   | 
   |   |   |   |   |       +-------|-|-----|---|-----|---------------------|---------|---------|-------------|---+   |       |       |     |   |         |     |   | |               | | |   +---+ |   | 
   |   |   |   |   |         |     | |     |   |     |     | |             |         |         | |           |   |   |       |       |     |   |         |     |   | |               | | |   | |   |   | 
   |   |   |   +-------------------|-|---------------------+ |         +-----------------------|-----------------|---|---------------------|-----------------------------------------|-|-------|-+ |   | 
   |   |   |       |         |     | |     |   |     |       |         |   |         |         | |           |   |   |       |       |     |   |         |     |   | |               | | |   | | | |   | 
   |   |   |       |         |     | |     |   |     |       |         |   |         |         | |           |   |   +---------------|---------|N--------------|-----+               | | |   | | | |   | 
   |   |   |       |         |     | |     |   |     |       |         |   |         |         | |           |   |           |       |     |   |         |     |   |                 | | |   | | | |   | 
   |   |   |   +-----------+ |     | |     +---|-----|-----------------|---+         |         | |         +-|---|-------------------|---------|---------|-----|---|-----------------|-|-|---+ | | |   | 
   |   |   |   |   |       | |     | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |   |       | |     | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |   |       | |     | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |   +-------|-|---+ | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |           | |   | | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |           | +-+ | | |         |     |       |         |   +-------------------|---------+ | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |           |   | | | |         |     |       |         |   |         |         | |       | | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   +---|-------|---------------|---|-|-----------+   |       |         |   |         |         | |       | | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
       |   |   |           |   | | | |         | |   |       |         |   |         |         | |       | | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
       |   |   |           |   +---|-+         | |   |       |         |   |   +-+   |         | |       +-+ |   +-------------------------|-----------------------|-----------------|---+     | | |   | 
       |   |   |           |     | |           | |   |       |         |   |   | |   |         | |           |               |       |     |   |         |     |   |                 | |       | | |   | 
       |   |   |           |     | |           | |   |       |         |   |   | |   | +-------|-------------|---------------|-------------|-------------------|-------------------+ | |       | | |   | 
       |   |   |           |     | |           | |   |       |         |   |   | |   | |       | |           |               |       |     |   |         |     |   |               | | |       | | |   | 
       |   |   |   +-------|-----|-------+     | |   |       |         |   |   | |   | |       | |           |               |       |     |   |         |     |   |               | | |       | | +-+ | 
       |   |   |   |       |     | |     |     | |   |       |         |   |   | |   | |       | |           |               |       |     |   |         |     |   |               | | |       | |   | | 
       |   |   |   |       |     | |     |     | |   |       +---------|---------------|---------|-----------|-----------------------------|-------------|---------|---------------|-|-----------|---+ | 
       |   |   |   |       |     | |     |     | |   |                 |   |   | |   | |       | |           |               |       |     |   |         |     |   |               | | |       | |     | 
       |   |   |   |       +-----|-|-----|-----|-----|-------+         |   |   | |   | |       | |       +-----------------------+   |     |   |         |     |   |               | | |     +-------+ | 
       |   |   |   |             | |     |     | |   |       |         |   |   | |   | |       | |       |   |               |   |   |     |   |         |     |   |               | | |     | | |   | | 
       |   |   |   |             | |     |     | |   |       |         |   |   | |   | | +-----------------------------------|---|-------------|---------|-----|-------------------------------|-+ +-+ | 
       |   |   |   |             | |     |     | |   |       |         |   |   | |   | | |     | |       |   |               O   |   |     |   |         |     |   |               | | |     | |   |   | 
       |   |   |   |     +-------|-------|-----------|-------|-------------|-----|---|-|-------|---------|---|-------------------|-----------------------------|-----------------+ | | |     | |   |   | 
       |   |   |   |     |       | |     |     | |   |       |         |   |   | |   | | |     | |       |   |               |   |   |     |   |         |     |   |             | | | |     | |   |   | 
       |   |   |   |     |       | |     |     | |   |       |         |   |   | |   | | |     | |       |   |       +-+     |   |   |     |   |         |     |   |             | | | |     | |   |   | 
       |   |   |   |     |       | |     |     | |   |       |         |   |   | |   | | |     | |       |   |       | |     |   |   |     |   |         |     |   |             | | | |     | |   |   | 
       |   |   |   |     |   +---|-|-----|-----|-|--R|-------|-------------|---|---------------|-------------|-------|-|---------|---------|---|---------|---------|-----------------|-|-----------|-+ | 
       |   |   |   |     |   |   | |     |     | |   |       |         |   |   | |   | | |     | |       |   |       | |     |   |   |     |   |         |     |   |             | | | |     | |   | | | 
       |   |   |   |   +-----+   | |     |     | |   |       |         |   |   | |   | | |     | |       +---------------------------|-------------------|-----------------------+ | | |     | |   | | | 
       |   |   |   |   | |       | |     |     | |   |       |         |   |   | |   | | |     | |           |       | |     |   |   |     |   |         |     |   |               | | |     | |   | | | 
       |   |   |   |   | |       | |     |     | |   |     +-----------|-------|-|-------|-------|-----------|-------|-------|-------------|---------------------------------+     | +-------+ |   | | | 
       |   |   |   |   | |       | |     |     | |   |     | |         |   |   | |   | | |     | |           |       | |     |   |   |     |   |         |     |   |         |     |   |       |   | | | 
       |   |   |   |   | |       | +-----|-------|---------|-----------|---|-----|-------------|-|---------------------------------+ |     |   |         |     |   |         |   +-----|-------|---+ | | 
       |   |   |   |   | |       |       |     | |   |     | |         |   |   | |   | | |     | |           |       | |     |   | | |     |   |         |     |   |         |   | |   |       |     | | 
       |   |   | +---------------|-------|S------|---|-----+ |         |   |   | |   | | |     | |   +-------|---------|---------|---------|---|-------+ +---------|-------------+ |   |       |     | | 
       |   |   | | |   | |       |       |     | |   |       |         |   |   | |   | | |     | |   |       |       | |     |   | | |     |   |       |       |   |         |     |   |       |     | | 
       |   |   | | |   | |   +-----------------|-----|-------|-------------|-----|---|---|-----|-|-----------|-------|-|-----|---|-|-+     |   |       |       |   |         |     |   |       |     | | 
       |   |   | | |   | |   |   |       |     | |   |       |         |   |   | |   | | |     | |   |       |       | |     |   | |       |   |       |       |   |         |     |   |       |     | | 
       |   |   | | +-------------|-------------|-|---|-------|-------------|---------|-------------------------------|-------|-------------|-------+   |       |   |         |     |   |       |     | | 
       |   |   | |     | |   |   |       |     | |   |       |         |   |   | |   | | |     | |   |       |       | |     |   | |       |   |   |   |       |   |         |     |   |       |     | | 
       | +-|---|-|-----|-|---------------|-------|-----------|-------------------|-------------|-|---------------------|-----|---|-|-------|-------|---|---------+ |         |     |   |       |     | | 
       | | |   | |     | |   |   |       |     | |   |       |         |   |   | |   | | |     | |   |       |       | |     |   | |       |   |   |   |       | | |         |     |   |       |     | | 
       | | |   | |     | |   | +---------|-----|-|-------+   |         |   |   | |   | | |     | |   |       |       | |     |   +-------------|-----------------|-----+     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |         |   |   | |   | | |     | |   |       |       | |     |     |       |   |   |   |       | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |       +-|---|---|---------|-------|-------------------------------------------------|---|-----+ | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |       | |   |   | |   | | |     | |   |       |       | |     |     |       |   |   |   |     | | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |       | |   |   | |   | | |     | |   |       |     +-|-|-----------|-------------------+     | | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |       | |   |   | |   | | |     | |   |       |     | | |     |     |       |   |   |         | | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | +---+   |     | |   |   |   |       | +-+ |   | |   | +-+ +---|-|---|-------|-----|-|-------------|-----------|---|---------|-|-------|-----|---------|-------------|-+ 
       | | |   | |     | |   | |     |   |     | |   |   |   |       |   | |   | |   |     |   | |   |       |     | | |     |     |       |   |   |         | | | |   |     |     |   |       |     |   
       | | |   | |     | |   | |     |   |     | |   |   |   |       |   | |   | |   |     |   | |   |       |     | | |     |     |       |   |   |         | | | |   |     | +-------|-------|-----+   
       | | |   | |     | |   | |     |   |     | |   |   |   |       |   | |   | |   |     |   | |   |       |     | | |     |     |       |   |   |         | | | |   |     | |   |   |       |         
   +---|-|-|---|-------|-|-----|---------|-----|-----|---|---+       |   | |   | |   |     | +-|-|---|-------|-----|---|-----------|---+   |   |   |         | | | |   |     | |   |   |       |         
   |   | | |   | |     | |   | |     |   |     | |   |   |           |   | |   | |   |     | | | |   |       |     | | |     |     |   |   |   |   |         | | | |   |     | |   |   |       |         
   |   | +-------|-----|-|-----|-----|---|-----------|-------------------|-|---|-----|-----|-+ | |   |       |     | | |     |     +-----------|---|-------+ | | | |   |     | |   |   |       |         
   |   |   |   | |     | |   | |     |   |     | |   |   |           |   | |   | |   |     |   | |   |       |     | | |     |         |   |   |   |       | | | | |   |     | |   |   |       |         
   | +-+   |   | |     | |   | |     |   |     | |   |   |           |   | |   | |   |     |   | |   |       |     | | |     |         |   |   |   |       | | | | |   |     | |   |   |       |         
   | |     |   | |     | |   | |     |   |     | |   |   |           |   | |   | |   |     |   | |   |       |     | | |     |         |   |   |   |       | | | | |   |     | |   |   |       |         
   | |   +-----|-------|-|---|-|-+   |   +-----|---------------------|-----|---|-----|-----|---|-|---|-------------------------+       |   |   |   +-------|---|-|-|---|-----+ |   |   |       |         
   | |   | |   | |     | |   | | |   |         | |   |   |           |   | |   | |   |     |   | |   |       |     | | |     | |       |   |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | | +-------------------|---------------------------|---------+ +---|-----------+     +-|-+     | +-------|-+ |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |   |           |   | |   | |   |       | | |   |               |       |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |   +---------------|---------------------------------------------+     |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |       | | |   |               | |     |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |       | | |   |               | |     |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |       | | |   |               | |     |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |   +---|---|---|-----------------|-----|-----------|-|---------------|-|---+ |   |       |   |   |     +-|-------+ 
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |   |   | | |   |               | |     |         | | |   |           | | |   |   |       |   |   |     | |       | 
 +---|-----|---|-|-----|-|-----|-----|--U--------|---|-----------------------+ | |   |   |   | | |   |               | |     |         | | |   |           | | |   |   |       |   |   |     | |       | 
 | | |   | |   | |     | |   | |     |         | |   |               |   | | | | |   |   |   | | |   |               | |     |         | | |   |           | | |   |   |       |   |   |     | |       | 
 | | |   | |   | |     | |   | |     |         | |   |               |   | | | +-----------+ | | |   |               | |     |         | | |   |           | | |   |   +-----+ |   +---|-+   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |               |   | | |   |   |   | | | | |   |               | |     |         | | |   |           | | |   |         | |       | |   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |         +-----|---|-|---------|---|-|-|-+ |   |               | |     |         | | |   |           | | |   |       +---+       | |   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |         |     |   | | |   |   |   | | |   |   |               | |     |         | | |   |           | | |   |       | |         | |   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |         |     |   | | |   |   |   | | |   | +-----------------+ |     |         | | |   |           | | |   |       | |         | |   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |         |     |   | | |   |   |   | | |   | | |                 |     |         | | |   |           | | |   |       | |         | |   | |       | 
 | | |   | |   | | +---|-|D--|-------+ +---------|---|---------|-----|-----|---------|---|-|---+ | | |                 |     |         | +-|---------------|---------------|-|---------|-|---|-------+ | 
 | | |   | |   | | |   | |   | |       |       | |   |         |     |   | | |   |   |   | | | | | | |                 |     |         |   |   |           | | |   |       | |         | |   | |     | | 
 | | |   | |   | | |   | |   | |       |       | |   |         |     |   | | |   |   | +---|---|-|-|-------------------|-----------------------+           | | |   |       | |         | |   | |     | | 
 | | |   | |   | | |   | |   | |       |       | |   |         |     |   | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |       | |         | |   | |     | | 
 | | |   | |   | | +---|-------|---+   +-------|-|---|---------|-----+   | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |       | |         | |   | |     | | 
 | | |   | |   | |     | |   | |   |           | |   |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |       | |         | |   | |     | | 
 | | +---|-----|---+   | |   | |   |           +---------------------------------------|-|-|-|-|-|---|-----------------|-----|-------------|---------------------------+   | |   +-----|-----|-------+ | 
 | |     | |   | | |   | |   | |   |             |   |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   |     | |   | |       | 
 | |     | | +---|-+   | |   | |   |             |   |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   |     | |   | |       | 
 | |     | | | | |     | |   | |   |             |   |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   |     | |   | |       | 
 | |     | | | | |     | |   | |   |             +-------------|---------|---|-------|---|-|-|---|---|-----------------|-----|---------|-----------------------|-------|---|-----|-------|---|-+       | 
 | |     | | | | |     | |   | |   |                 |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   |     | |   |         | 
 | |     | | | | | +---|-|---------|-----------------|---------|---------|-|-----+   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   +-----------|-----+   | 
 | |     | | | | | |   | |   | |   |                 |         |         | | |       | | | | | | | | |                 |     |         |   |               | | |   |   |   | |         | |   |     |   | 
 | |     | | | | | |   | |   | |   |                 |         |         | | |       +-|-|---|-|-----+                 |     |         |   |   +-----------|-------|---|---|-+ +-------|-----|-----|-+ | 
 | |     | | | | | |   | |   | |   |                 |         |         | | |         | | | | | | |                   |     |         |   |   |           | | |   |   |   |   |       | |   |     | | | 
 | |     | | | | | |   | |   | |   |                 |   +---------------|---|---------|-|-----|-|-|-------------------|---------------|---|---------------|-|-|---|-------|-----+     | |   |     | | | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | | | | |                   |     |         |   |   |           | | |   |   |   |   | |     | |   |     | | | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | | +-|-|-------------------|-----|---------------+ +-----------|-|---------|-------|---------|---|-----|-+ | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | |   | |                   |     |         |   | |             | | |   |   |   |   | |     | |   |     |   | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       +-----------+     |         |   | |             | | |   |   |   |   | |     | |   |     |   | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |   | |             | | |   |   |   |   | |     | |   |     |   | 
 | |     | | | +---------|---|-|---|---------+       |   |     |         | | |   +-------|-|---------------|---------------------------|---|-----------------|-----+   |   |   | |     | |   |     |   | 
 | |     | | |   | |   | |   | |   |         |       |   |     |         | | |   |     | | | |   | |       |                 |         |   | |             | | |       |   |   | |     | |   |     |   | 
 | +-------+ |   | |   | |   | |   |         +---------------------------|-------------|---|---------------|---------------------------------------------------|---------------|-|-----------------|-+ | 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |   |     | | | |   | |       |                 |         |   | |             | | |       |   |   | |     | |   |     | | | 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |   +-----|-|---|-----------------------------------------|-------------------|-|-------------------+     | |   |     | | | 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |   | |             | | |       |   |   |       | |   |     | | | 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |   +-|---------------|-------------|---|-------|-|---|-----|---+ 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |     |             | | |       |   |   |       | |   |     | |   
 |       | +-------|---|-|---------------------------|---|---------------|---|---------|-----------|-------------------------|---------|-----|-+           | | |       |   |   |       | |   |     | |   
 |       | | |   | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |     | |           | | |       |   |   |       | |   |     | |   
 |       | | +---|-----------|-------------+         |   |     |         | | |         | | | |   | |       |                 |         |     | +-------------|-------------|---------+ | |   |     | |   
 |       | |     | |   | |   | |   |       |         |   |     |         | | |         | | | |   | |       |                 |         |     |             | | |       |   |   |     | | |   |     | |   
 |       | |     | |   | |   | |   |       |         |   |     |         | | |         | | | |   | |       |                 |         |     |       +-----|---+       |   |   |     | | |   |     | |   
 |       | |     | |   | |   | |   |       |         |   |     |         | | |         | | | |   | |       |                 |         |     |       |     | |         |   |   |     | | |   |     | |   
 |       | |     | |   +-|-----|---|---------------------|---------------|-|-|---------|---|-|---|---------------------------|-----------------------|-----------------|-------------|-|-+   |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   | |       |                 |         |     |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   | +-----------------------------------|-+   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | | +---------+         |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | | | |                 |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | | | |       +---------------------------------|---------------+   |         | +---------------|-----------------------|-----|-|---------|---------------|-----------|-|-+ 
 |       | |     | |     |   | | | |       |         |   |     |         | | |         | | |     |         | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | +-------------|-|-----------------------+         |   +-----|---------|-----------------|-----|-+       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | |     | |       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | |     | |       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | |     | |       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | | +---|-|-------|-|-------------------------|-----|-------------|-----------|---|-----+   | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | | |   | |       | |               |         | |   |       |     | |         |   |   | |   | |     |     | | | 
 | |     | |     | |     |   | | | |                 |   +-----------------|-----------|-------------------|-|---------------|---------|-|-----------------|-|---------|---|-----+   | |     |     | | | 
 | |     | |     | |     |   | | | |                 |   |     |         | | |         | | | |   | |       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |   +-----|-----------|-|---------|---|-----|-+       | |       +-------|---------|---------------------------------------|-----|---+   |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | | |   |         | |       |       |         | |   |       |     | |         |   |   |     | | |   |     | | | 
 | +-----|-------+ |     +---|---+ |                 |         |         | | |         | | | |   |         | |       |     +-|---------------|-------|-------------------------|-----|-|---+ |     | | | 
 |       | |       |         | |   |                 |         |         | | |         | | | |   |         | |       |     | |         | |   |       |     | |         |   |   |     | | | | |     | | | 
 |   +-----|-----------------|-|---|-----------------|---------|---------|-------------|---|---------------|-|-------|-----|-----------|-----|-------------|-----------|---|-----+   | | +-----+   | +-+ 
 |   |   | |       |         | |   |                 |         |         | | |         | | | |   |         | |       |     | |         | |   |       |     | |         |   |   | |   | |   | | |   |     
 |   |   | +-------|-+     +-|-+   |                 |         |         | | |         | | | |   |         | |       |     | |         | |   |       |     | |         |   | +-+ |   | |   | | |   |     
 |   |   |         | |     | |     |                 |         |         | | |         | | | |   |         | |       |     | |         | |   |       |     | |         |   | |   |   | |   | | |   |     
 |   |   |         +-|-----------------------------------------|-------------|-+       +-|-------------+   | |       |     | |         | |   +-------------|-----------|-----|---|---|-|---|-|-|---|---+ 
 |   |   |           |     | |     |                 |         |         | | | |         | | |   |     |   | |       |     | |         | |           |     | |         |   | |   |   | |   | | |   |   | 
 | +-------------------------|-----------------------|---------|-----------|-|-|-----------|-+   |     |   | | +-----------|-|-----------------------------------------|---|-|---|---|-|---|-|-|---+   | 
 | | |   |           |     | |     |                 |         |         | | | |         | |     |     |   | | |     |     | |         | |           |     | |         |   | |   |   | |   | | |       | 
 | | |   | +---------|-----|-|---+ |                 |         |         | | +-----------|-------------|-------|-------------|---------|-|---------+ |     | |         |   | |   |   | |   | | |       | 
 | | |   | |         |     | |   | |                 |         |         | |   |         | |     |     |   | | |     |     | |         | |         | |     | |         |   | |   |   | |   | | |       | 
 | | +---------------------|-----|-------------------|---------|-----------|---------------|-----|---------|---------------+ |         | |         +-----+ | |         |   | |   |   | +-----|-----+   | 
 | |     | |         |     | |   | |                 |         |         | |   |         | |     |     |   | | |     |       |         | |           |   | | |         |   | |   |   |     | | |   |   | 
 +-+     | +---------------+ +---------------------------------------------|---+         | |     |     |   | | |     |       |         | |   +-------|---------------------------+ +-------+ | +-+ |   | 
         |           |           | |                 |         |         | |             | |     |     |   | | |     |       |         | |   |       |   | | |         |   | |     | |       |   | |   | 
   +-----+ +---------------------------------------------------|-----------+             | |     +-------------------|-------|---------+ |   |       |   | | |         |   | +-------|---+   |   | |   | 
   |       |         |           | |                 |         |         |               | |           |   | | |     |       |           |   |       |   | | |         |   |       | |   |   |   | |   | 
   |       +-----+   +-----------|-|-----------------|-------------------+               | |       +---|-------------+     +-----------------|---------------|-------------------+ | |   +-+ |   +-+   | 
   |             |               | |                 |         |                         | |       |   |   | | |           | |           |   |       |   | | |         |   |     | | |     | |         | 
 +-+ +-----------|---------------|-------------------+         |                         | |   +---|---|-------------------|-|-----------|---|-----------|-+ |         |   |     | | |     | |       +-+ 
 |   |           |               | |                           |                         | |   |   |   |   | | |           | |           |   |       |   |   |         |   |     | | |     | |       |   
 | +-------------|-----------------|-----------------------------------------------------|-|---|---|-------|-|-------------|---------------------------------|---------|---|---------------|-+       |   
 | | |           |               | |                           |                         | |   |   |   |   | | |           | |           |   |       |   |   |         |   |     | | |     |         |   
 | | +-----------|-----------------|---------------------------|-----------------------------------|---|---|-|-|-------------------+     |   |       |   |   |         |   |   +-+ | |     |         |   
 | |             |               | |                           |                         | |   |   |   |   | | |           | |     |     |   |       |   |   |         |   |   |   | |     |         |   
 | |             |               | |                           |                         | +-------|---|---|-+ |           +-+     |     | +---------|---|---+         |   +-------+ |     |         |   
 | |             |               | |                           |                         |     |   |   |   |   |                   |     | | |       |   |             |       |     |     |         |   
 | |             |               +-------------------------------------------------------------|---|-------|-----------------------|-----+ +-+       |   |             |       +-----------+         |   
 | |             |                 |                           |                         |     |   |   |   |   |                   |                 |   |             |             |               |   
 +-|-------------------------------------+                     |                         +-----+   +---+   +---+                   +---------------+ +-+ +-------------|---------------------------+ |   
   |             |                 |     |                     |                                                                                   |   |               |             |             | |   
   |             |   +-------------+     +---+                 +---------------------------------------------------------------------------------------|---------------|-------------|-------------+ |   
   |             |   |                       |                                                                                                     |   |               |             |               |   
   +-----------------------------------------------------------------------------------------------------------------------------------------------+ K-+               +-------------+               |   
                 |   |                       |                                                                                                                                                       |   
                 +---+                       +-------------------------------------------------------------------------------------------------------------------------------------------------------+ """


def part1(input): 
    data = [list(line) for line in input.split("\n")]

    height = len(data)
    width = len(data[0])

    mat = np.chararray((height, width))
    for i, row in enumerate(data): 
        for j,col in enumerate(row): 
            mat[i,j] = str(col)

    vel = (1,0)
    i = 0 
    j = list(mat[0].find(b"|")).index(0)

    cnt_plus = 0

    letters = []
    last_cmd = b"|"

    count = 0

    while i >= 0 and i < height and j >=0 and j<width: 
        # print(i,j, mat[i,j], (mat[i,j] in (b'|', b'+', b'-')))
        cmd = mat[i,j]
        # print(i, j, cmd)

        if cmd == "": 
            break

        if not (mat[i,j] in (b'|', b'+', b'-')): 
            # print('letter!', mat[i,j])
            letters.append(mat[i,j])

        if cmd == b"+":
            # print('    before turn', vel==(1,0))
            if (vel == (1,0)) or (vel == (-1,0)): 
                # print("    h")
                if j < width-1 and mat[i, j+1]: 
                    vel = (0,1)
                else: 
                    vel = (0,-1)
            elif (vel == (0,1)) or (vel == (0,-1)): 
                if i < height-1 and mat[i+1, j]: 
                    vel = (1,0)
                else: 
                    vel = (-1,0)

            # print('    after turn', vel)
        i += vel[0]
        j += vel[1]

        # print("    ", vel, i,j)
        count += 1
        # exit(0)
    return ''.join([x.decode('utf-8') for x in letters]), count



# print(part1(test1))
print(part1(real))
    